import React from 'react';

import Box from '@mui/material/Box';
import Divider from '@mui/material/Divider';
import { Text } from '@omniviewdev/ui/typography';
import { Tooltip } from '@omniviewdev/ui/overlays';
import { Chip, List, ListItem, ListDivider } from '@omniviewdev/ui';
import { parseCvssVector } from './utils';

type Props = {
  vector: string;
};

export const VulnerabilityVectorsList: React.FC<Props> = ({ vector }) => {
  return (
    <Box sx={{ borderRadius: 1, border: '1px solid', borderColor: 'divider' }}>
      <Text sx={{ p: 1.5, fontWeight: 700 }} weight='semibold' size='sm' component="div">
        CVSS Vector
      </Text>
      <Divider />
      <List size='sm'>
        {parseCvssVector(vector).map((display, index, arr) => (
          <>
            <ListItem key={index}>
              <Box
                sx={{
                  px: 0.5,
                  display: 'flex',
                  justifyContent: 'space-between',
                  alignItems: 'center',
                  width: '100%',
                }}
              >
                <Text size='sm' component="div">
                  {display.metric}
                </Text>
                <Tooltip content={display.description}>
                  <Chip variant='filled' color='default' sx={{ borderRadius: 1 }} label={display.value} />
                </Tooltip>
              </Box>
            </ListItem>
            {index < arr?.length - 1 && <ListDivider />}
          </>
        ))}
      </List>
    </Box>
  );
};

export default VulnerabilityVectorsList;
